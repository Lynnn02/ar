<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test GLB Models</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #222;
        }
        
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
        }
        
        .controls button {
            margin: 5px;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        
        .controls button:hover {
            background: #0056b3;
        }
        
        .info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h3>GLB Model Test</h3>
        <button onclick="loadModel('normal')">Load Normal Model</button>
        <button onclick="loadModel('faulty')">Load Faulty Model</button>
        <button onclick="resetView()">Reset View</button>
        <button onclick="toggleWireframe()">Toggle Wireframe</button>
        <div style="margin-top: 10px;">
            <label>Scale: <input type="range" id="scaleSlider" min="0.1" max="3" step="0.1" value="1" onchange="updateScale()"></label>
        </div>
    </div>
    
    <div class="info" id="info">
        <div><strong>Model Info:</strong></div>
        <div id="modelStatus">No model loaded</div>
        <div id="modelDetails"></div>
        <div style="margin-top: 10px;">
            <strong>Controls:</strong><br>
            • Mouse: Rotate view<br>
            • Scroll: Zoom<br>
            • WASD: Move camera
        </div>
    </div>
    
    <a-scene background="color: #222" stats>
        <a-assets>
            <a-asset-item id="normal-model" src="./model.glb" crossorigin="anonymous"></a-asset-item>
            <a-asset-item id="faulty-model" src="./acc4.glb" crossorigin="anonymous"></a-asset-item>
        </a-assets>
        
        <!-- Camera -->
        <a-camera 
            id="camera"
            position="0 1.6 3"
            look-controls="enabled: true"
            wasd-controls="enabled: true">
        </a-camera>
        
        <!-- Model entity -->
        <a-entity
            id="model-entity"
            position="0 0 0"
            rotation="0 0 0"
            scale="1 1 1"
            animation-mixer>
        </a-entity>
        
        <!-- Ground plane -->
        <a-plane
            position="0 -0.5 0"
            rotation="-90 0 0"
            width="10"
            height="10"
            color="#333"
            opacity="0.8">
        </a-plane>
        
        <!-- Lighting -->
        <a-light type="ambient" color="#ffffff" intensity="0.6"></a-light>
        <a-light type="directional" position="2 4 2" color="#ffffff" intensity="0.8"></a-light>
        <a-light type="point" position="0 2 0" color="#ffffff" intensity="0.5"></a-light>
        
        <!-- Grid helper -->
        <a-entity
            geometry="primitive: plane; width: 10; height: 10"
            material="color: #444; wireframe: true; opacity: 0.3"
            position="0 -0.49 0"
            rotation="-90 0 0">
        </a-entity>
    </a-scene>
    
    <script>
        let currentModel = null;
        let modelEntity;
        let isWireframe = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            modelEntity = document.getElementById('model-entity');
            
            // Test loading both models on startup
            console.log('Testing GLB model loading...');
            loadModel('normal');
        });
        
        function loadModel(modelType) {
            const modelSrc = modelType === 'normal' ? '#normal-model' : '#faulty-model';
            const modelName = modelType === 'normal' ? 'Normal Airflow' : 'Faulty Airflow';
            
            console.log(`Loading ${modelName} model:`, modelSrc);
            updateStatus(`Loading ${modelName}...`);
            
            // Clear previous model
            modelEntity.removeAttribute('gltf-model');\n            \n            // Small delay to ensure cleanup\n            setTimeout(() => {\n                modelEntity.setAttribute('gltf-model', modelSrc);\n                currentModel = modelType;\n                \n                // Add event listeners\n                modelEntity.addEventListener('model-loaded', function(event) {\n                    console.log(`${modelName} loaded successfully`);\n                    updateStatus(`${modelName} loaded successfully`);\n                    \n                    // Get model info\n                    const model = event.detail.model;\n                    if (model) {\n                        const box = new THREE.Box3().setFromObject(model);\n                        const size = box.getSize(new THREE.Vector3());\n                        updateDetails(`Size: ${size.x.toFixed(2)} x ${size.y.toFixed(2)} x ${size.z.toFixed(2)}`);\n                    }\n                });\n                \n                modelEntity.addEventListener('model-error', function(error) {\n                    console.error(`${modelName} failed to load:`, error);\n                    updateStatus(`Failed to load ${modelName}`);\n                    updateDetails('Check browser console for details');\n                });\n            }, 100);\n        }\n        \n        function updateStatus(message) {\n            document.getElementById('modelStatus').textContent = message;\n        }\n        \n        function updateDetails(message) {\n            document.getElementById('modelDetails').textContent = message;\n        }\n        \n        function resetView() {\n            modelEntity.setAttribute('position', '0 0 0');\n            modelEntity.setAttribute('rotation', '0 0 0');\n            modelEntity.setAttribute('scale', '1 1 1');\n            document.getElementById('scaleSlider').value = 1;\n            \n            const camera = document.getElementById('camera');\n            camera.setAttribute('position', '0 1.6 3');\n            camera.setAttribute('rotation', '0 0 0');\n        }\n        \n        function updateScale() {\n            const scale = document.getElementById('scaleSlider').value;\n            modelEntity.setAttribute('scale', `${scale} ${scale} ${scale}`);\n        }\n        \n        function toggleWireframe() {\n            isWireframe = !isWireframe;\n            \n            if (isWireframe) {\n                modelEntity.setAttribute('material', 'wireframe: true');\n            } else {\n                modelEntity.removeAttribute('material');\n            }\n        }\n        \n        // Debug info\n        console.log('A-Frame version:', AFRAME.version);\n        console.log('Available components:', Object.keys(AFRAME.components));\n        \n        // Check if GLB files exist\n        fetch('./model.glb')\n            .then(response => {\n                if (response.ok) {\n                    console.log('✅ model.glb found and accessible');\n                } else {\n                    console.error('❌ model.glb not found or not accessible');\n                }\n            })\n            .catch(error => {\n                console.error('❌ Error checking model.glb:', error);\n            });\n            \n        fetch('./acc4.glb')\n            .then(response => {\n                if (response.ok) {\n                    console.log('✅ acc4.glb found and accessible');\n                } else {\n                    console.error('❌ acc4.glb not found or not accessible');\n                }\n            })\n            .catch(error => {\n                console.error('❌ Error checking acc4.glb:', error);\n            });\n    </script>\n</body>\n</html>
